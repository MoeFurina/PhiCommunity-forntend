(()=>{"use strict";const t=["_imageBitmapOptions","resizeWidth","resizeHeight","resizeQuality","imageOrientation"],e=["_Blob","_ImageData","_SVGBlob","_SVGImageElement"],a=["resizeWidth","resizeHeight","resizeQuality","imageOrientation","premultiplyAlpha","colorSpaceConversion"],n={ResizeQuality:["pixelated","low","medium","high"],ImageOrientation:["none","flipY"]},i={COMMON_HEADER:"Failed to execute 'createImageBitmap': ",INVALID_STATE_IMAGE:"Provided image was in an invalid state.",ARGUMENT_COUNT_1:"At least one argument is required.",ARGUMENT_COUNT_N:"%s is not a valid argument count for any overload",CROP_RECT_ZERO:"The crop rect width passed to createImageBitmap must be nonzero",ALLOCATION_FAILED:"The ImageBitmap could not be allocated.",INVALID_SOURCE:"Argument 1 could not be converted to any of: HTMLImageElement, SVGImageElement, HTMLCanvasElement, HTMLVideoElement, ImageBitmap, Blob, CanvasRenderingContext2D, ImageData.",ENUM:"'%v' is not a valid value for enumeration %e",ALLOCATION:"The ImageBitmap couldn't be allocated."},r=["HTMLImageElement","SVGImageElement","HTMLVideoElement","HTMLCanvasElement","OffscreenCanvas","ImageBitmap"],o="http://www.w3.org/2000/svg",s="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7",c=new Int32Array(1);function h(t){return Number.isFinite(t)?(c[0]=t,c[0]):NaN}function l(t){const e=h(t);if(isNaN(e))throw new TypeError("Invalid long value");return e}function g(t,e){const a=Object.assign(document.createElement("canvas"),{width:t,height:e}).getContext("2d");if(t&&e&&!function(t){if(t.isContextLost)return t.translate(0,0),!t.isContextLost();let e=!1;try{t.fillRect(0,0,1,1),e=0!==t.getImageData(0,0,1,1).data[3]}finally{return t.clearRect(0,0,1,1),e}}(a))throw new DOMException(i.ALLOCATION,"InvalidStateError");return a}function m(t){return e=>{const a=globalThis[e];return a&&t instanceof a}}const u=globalThis.createImageBitmap,d=!!u&&((...t)=>u.call(globalThis,...t));function w(t){const e=new Image;return e.src=t,new Promise((t,a)=>{e.onload=a=>{y(e),t(e)},e.onerror=t=>{const e=new DOMException(i.INVALID_STATE_IMAGE,"InvalidStateError");a(e)}})}const f=i.COMMON_HEADER;function p(t,e,a){const r=n[a],o=t[e];if(void 0!==o&&!r.includes(o)){const t=i.ENUM.replace("%v",o).replace("%e",a);throw new TypeError(t)}}function I(t){const e=m(t);return e("HTMLImageElement")?{width:t.naturalWidth,height:t.naturalHeight}:e("HTMLVideoElement")?{width:t.videoWidth,height:t.videoHeight}:e("SVGImageElement")?{width:NaN,height:NaN}:e("HTMLCanvasElement")||e("OffscreenCanvas")||e("ImageBitmap")||e("ImageData")?t:{width:NaN,height:NaN}}function E(t,e){const a=function(t,e){const{width:a,height:n}=I(t),{resizeWidth:i,resizeHeight:r}=e,o=e.cropRect||{sx:0,sy:0,sw:a,sh:n},s={dx:0,dy:0,dw:i||Math.abs(o.sw),dh:r||Math.abs(o.sh)},c=function(t,e,{sx:a,sy:n,sw:i,sh:r},{dx:o,dy:s,dw:c,dh:h}){i<0&&(a+=i,i=Math.abs(i)),r<0&&(n+=r,r=Math.abs(r)),c<0&&(o+=c,c=Math.abs(c)),h<0&&(s+=h,h=Math.abs(h));const l=Math.max(a,0),g=Math.min(a+i,t),m=Math.max(n,0),u=Math.min(n+r,e),d=c/i,w=h/r;return{sx:l,sy:m,sw:g-l,sh:u-m,dx:a<0?o-a*d:o,dy:n<0?s-n*w:s,dw:(g-l)*d,dh:(u-m)*w}}(a,n,o,s);return c.resizeQuality=e.resizeQuality,c.flipY="flipY"===e.imageOrientation,c.width=s.dw,c.height=s.dh,c}(t,e),{height:n}=I(t),{sx:i,sy:r,sw:o,sh:s,dx:c,dy:h,dw:l,dh:m,flipY:u,resizeQuality:d}=a,w=g(a.width,a.height),f=w.canvas;return"pixelated"===d?w.imageSmoothingEnabled=!1:d&&(w.imageSmoothingQuality=d),w.drawImage(t,i,r,o,s,c,h,l,m),u&&(w.globalCompositeOperation="copy",w.setTransform(1,0,0,-1,0,f.height),w.drawImage(f,0,0)),f}function A(){const t=i.COMMON_HEADER+i.INVALID_STATE_IMAGE;throw new DOMException(t,"InvalidStateError")}function y(t){const e=m(t);if(e("HTMLCanvasElement")||e("OffscreenCanvas")||e("ImageBitmap"))0!==t.width&&0!==t.height||A();else if(e("HTMLImageElement")||e("HTMLVideoElement")||e("SVGImageElement")){const{width:e,height:a}=I(t);0!==e&&0!==a||A();let n=!1;try{n=!g(0,0).createPattern(t,"no-repeat")}catch(t){return"maybe"}n&&A()}return!0}let T=!1;const b=function(){if(!d){const a=t.concat(e);return new Set(a)}const a=[M()],n=new Set(a.flat()),i=t.filter(t=>!n.has(t));return new Set(i)}(),O=async function(){if(!d)return T=!0,b;const t=[_(),N(),v(),L()],a=await Promise.all(t),n=new Set(a.flat());return e.filter(t=>!n.has(t)).forEach(t=>b.add(t)),T=!0,b}();function M(){const t=[],e={};return a.forEach(a=>{Object.defineProperty(e,a,{get(){t.push(a)}})}),d(new ImageData(1,1),e).then(t=>t.close()).catch(()=>{}),t.length&&t.push("_imageBitmapOptions"),t}async function _(){const t=[],e=await fetch(s).then(t=>t.ok&&t.blob());try{1===(await d(e)).width&&t.push("_Blob")}catch(t){console.log(t)}return t}async function N(){const t=[],e=function(){try{return new ImageData(1,1)}catch(t){return create2dContext(0,0).createImageData(1,1)}}();try{1===(await d(e)).width&&t.push("_ImageData")}catch(t){}return t}async function v(){const t=[],e=new Blob([`<svg width="1" height="1" xmlns="${o}">\n      <rect width="1" height="1"/>\n    </svg>`],{type:"image/svg+xml"});try{1===(await d(e)).width&&t.push("_SVGBlob")}catch(t){}return t}async function L(){const t=[];if(!("SVGImageElement"in globalThis))return t;const e=t=>new Promise(e=>setTimeout(e,t)),a=document.createElementNS(o,"image");a.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",s);const n=()=>{try{return y(a),!1}catch(t){return!0}};let i=0;do{await e(10)}while(n()&&++i<300);try{await d(a),t.push("_SVGImageElement")}catch(t){console.error(t)}return t}const S=t=>Object.getOwnPropertyDescriptor(HTMLCanvasElement.prototype,t);function C(){throw new TypeError("Illegal Constructor")}C.prototype=Object.create({close(){S("width").set.call(this,0),S("height").set.call(this,0)},get width(){return S("width").get.call(this)},get height(){return S("height").get.call(this)},get[Symbol.toStringTag](){return"ImageBitmap"}}),d||(globalThis.ImageBitmap=C),globalThis.createImageBitmap=async function(t,...e){const a=function(t,...e){let a,[n,r,o,s]=e.map(h);const c=(1===e.length?e[0]:e[4])||{},g="resizeWidth"in c&&l(c.resizeWidth),m="resizeHeight"in c&&l(c.resizeHeight);p(c,"resizeQuality","ResizeQuality"),p(c,"imageOrientation","ImageOrientation");const u=arguments.length;if(!u)throw new TypeError(f+i.ARGUMENT_COUNT_1);if(u>2&&u<5)throw i.ARGUMENT_COUNT_N.replace("%s",u),new TypeError(f+err_count_msg);if(u>=5){if(!o||!s)throw new RangeError(f+i.CROP_RECT_ZERO);n=n||0,r=r||0,a={sx:n,sy:r,sw:o,sh:s}}if(0===g||0===m){const t=f+i.ALLOCATION_FAILED;throw new DOMException(t,"InvalidStateError")}return{cropRect:a,...c}}(...arguments),n=function(t){if(T)return!1;const e=m(t);return["Blob","ImageData","SVGImageElement"].some(e)}(t)?await O:b;if(0===n.size)return d(...arguments);if(d&&!function(t,e,a){const n=m(a);if(n("Blob")){if(t.has("_Blob"))return!0;if(t.has("_SVGBlob"))return!0}return!(!n("ImageData")||!t.has("_ImageData"))||!(!n("SVGImageElement")||!t.has("_SVGImageElement"))||!!Object.keys(e).some(e=>t.has(e))}(n,a,t))return d(...function(t,...e){const a=e.length;return t.has("_imageBitmapOptions")&&[2,6].includes(a)?e.slice(0,a-1):e}(n,...arguments));const o=m(t);let s;if(r.some(o)?(y(t),o("SVGImageElement")&&(t=await function(t){return w(t.getAttribute("href")||t.getAttributeNS("http://www.w3.org/1999/xlink","href"))}(t)),o("HTMLImageElement")&&(t.naturalWidth||t.naturalHeight||a.resizeWidth&&a.resizeHeight||A()),s=E(t,a)):o("Blob")?s=await async function(t,e){const a=globalThis.URL.createObjectURL(t),n=await w(a);return globalThis.URL.revokeObjectURL(t),E(n,e)}(t,a):o("ImageData")&&(function(t){try{return t.slice(0,0),!1}catch(t){return!0}}(t.data.buffer)&&A(),s=await async function(t,e){const{resizeWidth:a,resizeHeight:n,resizeQuality:i,imageOrientation:r}=e,o=e.cropRect||{},s=o.sx||0,c=o.sy||0,h=o.sw||t.width,l=o.sh||t.height,m=h<0?-1*h-s:-s,u=l<0?-1*l-c:-c,d=g(Math.abs(h),Math.abs(l));d.putImageData(t,m,u,s,c,h,l);const w="flipY"===r,f=a||w;let p;a?(p=g(a,n),"pixelated"===i?p.imageSmoothingEnabled=!1:p.imageSmoothingQuality=i):(p=d,d.globalCompositeOperation="copy");const I=d.canvas,E=p.canvas;return w&&p.setTransform(1,0,0,-1,0,E.height),f&&p.drawImage(I,0,0,I.width,I.height,0,0,E.width,E.height),E}(t,a)),!s)throw new TypeError(i.INVALID_SOURCE);return await function(t){return t instanceof globalThis.ImageBitmap?t:d?d(t):function(t){return t instanceof HTMLCanvasElement||(t=E(t)),Object.setPrototypeOf(t,C.prototype),t}(t)}(s)},globalThis.createImageBitmap._original=d})();