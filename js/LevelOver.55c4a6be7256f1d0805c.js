(()=>{var e={472:(e,t,o)=>{e.exports=o.p+"assets/B15B.75b2.svg"},4962:(e,t,o)=>{e.exports=o.p+"assets/C15C.574f.svg"},5666:(e,t,o)=>{e.exports=o.p+"assets/S15S.d0cb.svg"},6888:(e,t,o)=>{e.exports=o.p+"assets/V15V.5992.svg"},7304:(e,t,o)=>{e.exports=o.p+"assets/F15F.8053.svg"},9446:(e,t,o)=>{e.exports=o.p+"assets/A15A.4a3b.svg"},9502:(e,t,o)=>{e.exports=o.p+"assets/phi15phi.36be.svg"},9819:(e,t,o)=>{e.exports=o.p+"assets/V15FC.6454.svg"}},t={};function o(r){var a=t[r];if(void 0!==a)return a.exports;var n=t[r]={exports:{}};return e[r](n,n.exports,o),n.exports}o.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return o.d(t,{a:t}),t},o.d=(e,t)=>{for(var r in t)o.o(t,r)&&!o.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:t[r]})},o.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),o.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),(()=>{var e;o.g.importScripts&&(e=o.g.location+"");var t=o.g.document;if(!e&&t&&(t.currentScript&&"SCRIPT"===t.currentScript.tagName.toUpperCase()&&(e=t.currentScript.src),!e)){var r=t.getElementsByTagName("script");if(r.length)for(var a=r.length-1;a>-1&&(!e||!/^http(s?):/.test(e));)e=r[a--].src}if(!e)throw new Error("Automatic publicPath is not supported in this browser");e=e.replace(/^blob:/,"").replace(/#.*$/,"").replace(/\?.*$/,"").replace(/\/[^\/]+$/,"/"),o.p=e+"../"})(),(()=>{"use strict";const e=o.p+"assets/LevelOver0.78f9.ogg",t=o.p+"assets/LevelOver1.83d3.ogg",r=o.p+"assets/LevelOver2.d36e.ogg",a=o.p+"assets/LevelOver3.ad57.ogg";var n=o(9502),s=o.n(n),l=o(9819),c=o.n(l),i=o(6888),d=o.n(i),g=o(5666),u=o.n(g),p=o(9446),m=o.n(p),w=o(472),y=o.n(w),S=o(4962),v=o.n(S),h=o(7304),b=o.n(h);const f={ez:0,hd:1,in:2,at:3},I=window.location.hostname.includes("cf")?"https://cf.charts.phicm.focalors.ltd":window.location.hostname.includes("vercel")?"https://vercel.charts.phicm.focalors.ltd":"https://charts.phicm.focalors.ltd";window.addEventListener("DOMContentLoaded",()=>{const o=new(window.AudioContext||window.webkitAudioContext||window.mozAudioContext||window.msAudioContext);document.querySelector("div#avatarBar").addEventListener("click",e=>{var t=e.target;null==t.classList.toString().match("avatarBar")&&(t=e.target.parentElement),t.classList.toString().match("expand")?t.classList.remove("expand"):t.classList.add("expand")}),null!=window.localStorage.getItem("playerName")&&(console.log("Setting player name: ",window.localStorage.getItem("playerName")),document.querySelector("div#avatarBar").setAttribute("data-name",window.localStorage.getItem("playerName"))),null!=window.localStorage.getItem("playerAvatar")&&(console.log("Setting player avatar: ",window.localStorage.getItem("playerAvatar")),document.querySelector("div#avatarBar").children[0].setAttribute("style",'--avatar: url("'+window.localStorage.getItem("playerAvatar")+'");'));const n=sessionStorage.getItem("play"),l=sessionStorage.getItem("level"),i=f[l],g=parseInt(sessionStorage.getItem("score")),p=sessionStorage.getItem("maxCombo"),w=sessionStorage.getItem("perfect"),S=sessionStorage.getItem("good"),h=sessionStorage.getItem("early"),x=sessionStorage.getItem("bad"),L=sessionStorage.getItem("miss"),R=sessionStorage.getItem("mode");switch(R){case"normal":"true"==sessionStorage.getItem("isNewBest")&&(document.querySelector("#scrollFrame").classList.add("newBest"),document.querySelector("#scrollFrame").setAttribute("data-nb","NEW BEST "+sessionStorage.getItem("prevBest").toString().padStart(7,"0")+" +"+(g-sessionStorage.getItem("prevBest"))));break;case"auto":document.querySelector("#scrollFrame").classList.add("auto");break;case"hyper":document.querySelector("#scrollFrame").classList.add("hyper")}sessionStorage.clear();const B=Math.round((parseInt(w)+.65*parseInt(S))/(parseInt(w)+parseInt(S)+parseInt(x)+parseInt(L)+0)*1e4)/100,C=S-h;var q,A;0==g&&(console.log("No grade"),q="",A=""),g<699999&&0!=g&&(console.log("Grade: False"),q="F15F",A=b()),7e5<=g&&g<=819999&&(console.log("Grade:C"),q="C15C",A=v()),82e4<=g&&g<=879999&&(console.log("Grade:B"),q="B15B",A=y()),88e4<=g&&g<=919999&&(console.log("Grade:A"),q="A15A",A=m()),92e4<=g&&g<=959999&&(console.log("Grade:S"),q="S15S",A=u()),96e4<=g&&g<=999999&&(console.log("Grade:V"),q="V15V",A=d()),0==x&&0==L&&(console.log("Grade: V wih Full Combo"),q="V15FC",A=c()),1e6<=g&&(console.log("Grade:Phi"),q="phi15phi",A=s()),fetch(I+"/"+n+"/meta.json").then(e=>e.json()).then(s=>{window.window.playResult={score:g,grade:q,gradeURL:A,play:n,playLevel:i,songInfo:s,maxCombo:p,accuracy:B,perFect:w,good:S,bad:x,miss:L,early:h,late:C,playLevelString:l,mode:R},console.log(window.playResult);let c=e;switch(i){case 0:c=e;break;case 1:c=t;break;case 2:c=r;break;case 3:c=a}const d=new AbortController;var u,m;fetch(c,d.signal).then(e=>e.arrayBuffer()).then(e=>{o.decodeAudioData(e,function(e){var t=o.createBufferSource();t.buffer=e,t.loop=!0,t.connect(o.destination),t.start(0)})}),document.getElementById("retryBtn").addEventListener("click",()=>{null==o?d.abort():o.close(),location.href="../whilePlaying/index.html?play="+n+"&l="+l}),document.getElementById("backInResultBtn").addEventListener("click",()=>{null==o?d.abort():o.close(),location.href="../songSelect/index.html"}),document.body.setAttribute("style",`--background:url(${encodeURI(I+"/"+window.playResult.play+"/"+window.playResult.songInfo.illustration)});`),document.querySelector("#songImg").setAttribute("src",encodeURI(I+"/"+n+"/"+window.playResult.songInfo.illustration)),document.querySelector("#score").innerText=g.toString().padStart(7,"0"),fetch(A).then(e=>e.blob()).then(e=>{document.querySelector("#gradeImage").src=URL.createObjectURL(e)}),document.querySelector("#maxCombo").innerText=p,document.querySelector("#accuracy").innerText=B+"%",document.querySelector("#perfect").innerText=w,document.querySelector("#good").innerText=S,document.querySelector("#bad").innerText=x,document.querySelector("#miss").innerText=L,document.querySelector("#early").innerText=h,document.querySelector("#late").innerText=C,document.querySelector("div.songName#songName").innerText=window.playResult.songInfo.name,document.querySelector("div.levelString#levelString").innerText=window.playResult.playLevelString.toUpperCase()+" Lv."+Math.floor(window.playResult.songInfo[window.playResult.playLevelString.toLowerCase()+"Ranking"]||0),u=window.playResult.accuracy>=70?(Math.pow((window.playResult.accuracy-55)/45,2)*(window.playResult.songInfo[window.playResult.playLevelString.toLowerCase()+"Ranking"]||0)).toFixed(2):0,window.playResult.score<88e4&&(m=0),document.querySelector("#rks").innerText=u,console.log("ΔRKS:",u),console.log("ΔData(KB):",m)}).catch(()=>{alert("歌曲信息获取失败！")})})})()})();